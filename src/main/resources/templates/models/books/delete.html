<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<body>
    <div th:fragment="deleteBookModal" class="modal fade" id="deleteBookModal" tabindex="-1" data-bs-backdrop="static">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-danger text-white">
                    <h5 class="modal-title">
                        <i class="bi bi-exclamation-triangle me-2"></i>
                        Delete Book
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                
                <form id="deleteBookForm" th:action="@{/books/delete}" method="post">
                    <input type="hidden" id="deleteBookId" name="id" value="">
                    
                    <div class="modal-body">
                        <div class="alert alert-danger d-flex align-items-start mb-3">
                            <i class="bi bi-exclamation-triangle-fill fs-4 me-3 flex-shrink-0"></i>
                            <div>
                                <strong>Warning!</strong> This action cannot be undone.<br>
                                <small>All data related to this book including borrowing history will be permanently deleted.</small>
                            </div>
                        </div>
                        
                        <p class="mb-3">
                            Are you sure you want to delete this book?
                        </p>
                        
                        <div class="card bg-light border-danger">
                            <div class="card-body">
                                <h6 class="card-subtitle mb-2 text-muted">
                                    <i class="bi bi-book me-1"></i>
                                    Book Title:
                                </h6>
                                <p class="card-text fw-bold text-danger mb-0" id="deleteBookTitleDisplay">-</p>
                            </div>
                        </div>

                        <div class="mt-3">
                            <label for="deleteConfirmTitle" class="form-label fw-semibold">
                                Type the book title exactly to confirm deletion:
                                <span class="text-danger">*</span>
                            </label>
                            <input type="text" class="form-control" id="deleteConfirmTitle"
                                   placeholder="Type book title here"
                                   autocomplete="off"
                                   required>
                            <small class="form-text text-muted">
                                This is case-sensitive and must match exactly.
                            </small>
                        </div>
                    </div>
                    
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                            <i class="bi bi-x-lg me-2"></i>
                            Cancel
                        </button>
                        <button type="submit" class="btn btn-danger">
                            <i class="bi bi-trash me-2"></i>
                            Delete Permanently
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // (function() {
        //     const modal = document.getElementById('deleteBookModal');
        //     const confirmInput = document.getElementById('deleteConfirmTitle');
        //     // const deleteBtn = document.getElementById('confirmDeleteBtn');
        //     const deleteBtn = null;
        //     const titleDisplay = document.getElementById('deleteBookTitleDisplay');
        //     const form = document.getElementById('deleteBookForm');
            
        //     if (modal && confirmInput && deleteBtn && titleDisplay && form) {
        //         // Real-time validation
        //         confirmInput.addEventListener('input', function() {
        //             const inputValue = this.value.trim();
        //             const expectedTitle = titleDisplay.textContent.trim();
                    
        //             if (inputValue === expectedTitle) {
        //                 deleteBtn.disabled = false;
        //                 confirmInput.classList.remove('is-invalid');
        //                 confirmInput.classList.add('is-valid');
        //             } else {
        //                 deleteBtn.disabled = true;
        //                 confirmInput.classList.remove('is-valid');
        //                 if (inputValue.length > 0) {
        //                     confirmInput.classList.add('is-invalid');
        //                 } else {
        //                     confirmInput.classList.remove('is-invalid');
        //                 }
        //             }
        //         });

        //         // Prevent form submission if title doesn't match
        //         form.addEventListener('submit', function(e) {
        //             const inputValue = confirmInput.value.trim();
        //             const expectedTitle = titleDisplay.textContent.trim();
                    
        //             if (inputValue !== expectedTitle) {
        //                 e.preventDefault();
        //                 e.stopPropagation();
        //                 confirmInput.classList.add('is-invalid');
        //                 deleteBtn.disabled = true;
        //                 return false;
        //             }
        //         });

        //         // Reset modal when closed
        //         modal.addEventListener('hidden.bs.modal', function () {
        //             confirmInput.value = '';
        //             confirmInput.classList.remove('is-valid', 'is-invalid');
        //             // deleteBtn.disabled = true;
        //             titleDisplay.textContent = '-';
        //             form.reset();
        //         });

        //         // Reset validation saat modal dibuka
        //         modal.addEventListener('show.bs.modal', function () {
        //             confirmInput.value = '';
        //             confirmInput.classList.remove('is-valid', 'is-invalid');
        //             // deleteBtn.disabled = true;
        //             // Auto-focus ke input field
        //             setTimeout(function() {
        //                 confirmInput.focus();
        //             }, 500);
        //         });
        //     }
        // })();
    </script>
</body>
</html>
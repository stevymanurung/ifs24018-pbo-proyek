<!-- Modal Edit Book -->
<div th:fragment="editBookModal" class="modal fade" id="editBookModal" tabindex="-1" data-bs-backdrop="static">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header bg-gradient-warning text-dark">
                <h5 class="modal-title">
                    <i class="bi bi-pencil-square me-2"></i>
                    Edit Book
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            
            <form id="editBookForm" th:action="@{/books/edit}" method="post" th:object="${bookForm}">
                <input type="hidden" id="editBookId" th:field="*{id}" value="">
                
                <div class="modal-body">
                    <!-- Error Message -->
                    <div id="editErrorAlert" class="alert alert-danger alert-dismissible fade show d-none" role="alert">
                        <i class="bi bi-exclamation-triangle-fill me-2"></i>
                        <span id="editErrorMessage"></span>
                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                    </div>

                    <div class="row">
                        <!-- Title -->
                        <div class="col-md-12 mb-3">
                            <label for="editTitle" class="form-label fw-semibold">
                                <i class="bi bi-fonts me-1"></i>
                                Title <span class="text-danger">*</span>
                            </label>
                            <input type="text" class="form-control" id="editTitle" 
                                   th:field="*{title}" required maxlength="255"
                                   placeholder="Enter book title">
                            <div class="invalid-feedback">
                                Please provide a book title.
                            </div>
                            <div class="text-danger" th:if="${#fields.hasErrors('title')}" th:errors="*{title}"></div>
                        </div>

                        <!-- Author -->
                        <div class="col-md-6 mb-3">
                            <label for="editAuthor" class="form-label fw-semibold">
                                <i class="bi bi-person me-1"></i>
                                Author <span class="text-danger">*</span>
                            </label>
                            <input type="text" class="form-control" id="editAuthor" 
                                   th:field="*{author}" required maxlength="255"
                                   placeholder="Enter author name">
                            <div class="invalid-feedback">
                                Please provide an author name.
                            </div>
                            <div class="text-danger" th:if="${#fields.hasErrors('author')}" th:errors="*{author}"></div>
                        </div>

                        <!-- ISBN -->
                        <div class="col-md-6 mb-3">
                            <label for="editIsbn" class="form-label fw-semibold">
                                <i class="bi bi-upc-scan me-1"></i>
                                ISBN <span class="text-danger">*</span>
                            </label>
                            <input type="text" class="form-control" id="editIsbn" 
                                   th:field="*{isbn}" required maxlength="20"
                                   placeholder="978-xxx-xxxx-xx-x">
                            <div class="invalid-feedback">
                                Please provide a valid ISBN.
                            </div>
                            <div class="text-danger" th:if="${#fields.hasErrors('isbn')}" th:errors="*{isbn}"></div>
                        </div>

                        <!-- Category -->
                        <div class="col-md-6 mb-3">
                            <label for="editCategory" class="form-label fw-semibold">
                                <i class="bi bi-tag me-1"></i>
                                Category <span class="text-danger">*</span>
                            </label>
                            <select class="form-select" id="editCategory" th:field="*{category}" required>
                                <option value="">Select category...</option>
                                <option value="Fiction">Fiction</option>
                                <option value="Non-Fiction">Non-Fiction</option>
                                <option value="Science">Science</option>
                                <option value="Technology">Technology</option>
                                <option value="History">History</option>
                                <option value="Biography">Biography</option>
                                <option value="Education">Education</option>
                                <option value="Children">Children</option>
                                <option value="Comics">Comics</option>
                                <option value="Religion">Religion</option>
                                <option value="Art">Art</option>
                                <option value="Other">Other</option>
                            </select>
                            <div class="invalid-feedback">
                                Please select a category.
                            </div>
                            <div class="text-danger" th:if="${#fields.hasErrors('category')}" th:errors="*{category}"></div>
                        </div>

                        <!-- Stock -->
                        <div class="col-md-6 mb-3">
                            <label for="editStock" class="form-label fw-semibold">
                                <i class="bi bi-box-seam me-1"></i>
                                Stock <span class="text-danger">*</span>
                            </label>
                            <input type="number" class="form-control" id="editStock" 
                                   th:field="*{stock}" required min="1" max="9999"
                                   placeholder="Enter stock quantity">
                            <div class="invalid-feedback">
                                Stock must be at least 1.
                            </div>
                            <div class="text-danger" th:if="${#fields.hasErrors('stock')}" th:errors="*{stock}"></div>
                        </div>

                        <!-- Publisher -->
                        <div class="col-md-6 mb-3">
                            <label for="editPublisher" class="form-label fw-semibold">
                                <i class="bi bi-building me-1"></i>
                                Publisher
                            </label>
                            <input type="text" class="form-control" id="editPublisher" 
                                   th:field="*{publisher}" maxlength="255"
                                   placeholder="Enter publisher name (optional)">
                            <div class="text-danger" th:if="${#fields.hasErrors('publisher')}" th:errors="*{publisher}"></div>
                        </div>

                        <!-- Publication Year -->
                        <div class="col-md-6 mb-3">
                            <label for="editPublicationYear" class="form-label fw-semibold">
                                <i class="bi bi-calendar me-1"></i>
                                Publication Year
                            </label>
                            <input type="number" class="form-control" id="editPublicationYear" 
                                   th:field="*{publicationYear}"
                                   min="1000" max="2100"
                                   placeholder="YYYY (optional)">
                            <div class="text-danger" th:if="${#fields.hasErrors('publicationYear')}" th:errors="*{publicationYear}"></div>
                        </div>
                    </div>

                    <div class="alert alert-warning mb-0">
                        <i class="bi bi-info-circle me-2"></i>
                        <small>
                            <strong>Note:</strong> Editing stock will affect availability. 
                            Make sure borrowed books are accounted for.
                        </small>
                    </div>
                </div>
                
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="bi bi-x-lg me-2"></i>
                        Cancel
                    </button>
                    <button type="submit" class="btn btn-warning">
                        <i class="bi bi-save me-2"></i>
                        Update Book
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
<!-- Modal Edit Cover Book -->
<div th:fragment="editCoverModal" class="modal fade" id="editCoverModal" tabindex="-1" data-bs-backdrop="static">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header bg-gradient-primary text-white">
                <h5 class="modal-title">
                    <i class="bi bi-image me-2"></i>
                    Upload Book Cover
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            
            <form th:action="@{/books/edit-cover}" method="post" 
                  th:object="${coverBookForm}" 
                  enctype="multipart/form-data" 
                  id="editCoverForm">
                
                <input type="hidden" th:field="*{id}">
                
                <div class="modal-body">
                    <!-- Current Cover Preview (if exists) -->
                    <div th:if="${book != null and book.cover != null}" class="mb-3">
                        <label class="form-label fw-semibold">Current Cover:</label>
                        <div class="text-center border rounded p-3 bg-light">
                            <img th:src="@{'/books/cover/' + ${book.cover}}" 
                                 alt="Current cover" 
                                 style="max-width: 100%; max-height: 200px; border-radius: 4px;">
                        </div>
                    </div>

                    <!-- File Input -->
                    <div class="mb-3">
                        <label for="coverFile" class="form-label fw-semibold">
                            <i class="bi bi-file-image me-1"></i>
                            Select New Image File <span class="text-danger">*</span>
                        </label>
                        <input type="file" class="form-control" id="coverFile" 
                               name="coverFile" 
                               accept="image/jpeg,image/png,image/gif,image/webp"
                               required
                               onchange="previewCoverImage(this)">
                        <small class="form-text text-muted">
                            <i class="bi bi-info-circle me-1"></i>
                            Supported formats: JPG, PNG, GIF, WEBP (Max 5MB)
                        </small>
                    </div>

                    <!-- Image Preview -->
                    <div id="coverImagePreviewContainer" class="d-none">
                        <label class="form-label fw-semibold">
                            <i class="bi bi-eye me-1"></i>
                            Preview:
                        </label>
                        <div class="text-center border rounded p-3 bg-light">
                            <img id="coverImagePreview" src="" alt="Preview" 
                                 style="max-width: 100%; max-height: 400px; border-radius: 4px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                        </div>
                        <div class="text-center mt-2">
                            <small class="text-muted" id="imageFileInfo"></small>
                        </div>
                    </div>

                    <div class="alert alert-info mt-3 mb-0">
                        <i class="bi bi-lightbulb me-2"></i>
                        <small>
                            <strong>Tips for Best Results:</strong>
                            <ul class="mb-0 mt-2">
                                <li>Use high-quality images with good resolution</li>
                                <li>Recommended aspect ratio: 2:3 (e.g., 400x600px or 600x900px)</li>
                                <li>Avoid blurry or low-resolution images</li>
                                <li>Center the main subject in the image</li>
                            </ul>
                        </small>
                    </div>
                </div>
                
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="bi bi-x-lg me-2"></i>
                        Cancel
                    </button>
                    <button type="submit" class="btn btn-primary" id="uploadCoverBtn" disabled>
                        <span class="spinner-border spinner-border-sm me-2 d-none" role="status" id="uploadSpinner"></span>
                        <i class="bi bi-upload me-2" id="uploadIcon"></i>
                        <span id="uploadBtnText">Upload Cover</span>
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>